<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\dev\ConvertX.To\src\Core\ConvertX.To.Application\Helpers\SettingsBinder.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using FluentValidation;
using Microsoft.Extensions.Configuration;

namespace ConvertX.To.Application.Helpers;

public static class SettingsBinder
{
    public static TSettings Bind&lt;TSettings&gt;(IConfiguration configuration) where TSettings : class
    {
        var name = Activator.CreateInstance&lt;TSettings&gt;().GetType().Name;
        return BindKey&lt;TSettings&gt;(name, configuration);
    }

    public static TSettings BindKey&lt;TSettings&gt;(string key, IConfiguration configuration) where TSettings : class
    {
        var settings = Activator.CreateInstance&lt;TSettings&gt;();
        configuration.GetSection(key).Bind(settings);
        return settings;
    }

    public static TSettings BindAndValidate&lt;TSettings, TValidator&gt;(IConfiguration configuration) where TSettings : class
        where TValidator : AbstractValidator&lt;TSettings&gt;
    {
        var name = Activator.CreateInstance&lt;TSettings&gt;().GetType().Name;
        return BindKeyAndValidate&lt;TSettings, TValidator&gt;(name, configuration);
    }

    public static TSettings BindKeyAndValidate&lt;TSettings, TValidator&gt;(string key, IConfiguration configuration)
        where TSettings : class
        where TValidator : AbstractValidator&lt;TSettings&gt;
    {
        var settings = BindKey&lt;TSettings&gt;(key, configuration);
        var validator = Activator.CreateInstance&lt;TValidator&gt;();
        var validationResult = validator.Validate(settings);
        if (!validationResult.IsValid)
            throw new ValidationException($&quot;Failed binding {settings.GetType().Name} using ConfigurationBinder.Bind&quot;);
        return settings;
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,5,9,6,0],[10,9,10,73,0],[11,9,11,56,0],[12,5,12,6,0],[15,5,15,6,1],[16,9,16,62,1],[17,9,17,54,1],[18,9,18,25,1],[19,5,19,6,1],[23,5,23,6,1],[24,9,24,73,1],[25,9,25,79,1],[26,5,26,6,1],[31,5,31,6,1],[32,9,32,63,1],[33,9,33,64,1],[34,9,34,61,1],[35,9,35,39,1],[36,13,36,119,0],[37,9,37,25,1],[38,5,38,6,1]]);
    </script>
  </body>
</html>