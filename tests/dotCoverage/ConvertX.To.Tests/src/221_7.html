<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\dev\ConvertX.To\src\Infrastructure\ConvertX.To.Infrastructure.Persistence\Repositories\ConversionRepository.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using ConvertX.To.Application.Domain.Entities;
using ConvertX.To.Application.Interfaces.Repositories;
using ConvertX.To.Infrastructure.Persistence.Contexts;

namespace ConvertX.To.Infrastructure.Persistence.Repositories;

public class ConversionRepository : GenericRepository&lt;ConversionEntity, Guid&gt;, IConversionRepository
{
    public ConversionRepository(ApplicationDbContext dbContext) : base(dbContext)
    {
    }

    public override Task&lt;bool&gt; UpdateAsync(ConversionEntity entity)
    {
        if (entity.Downloads == 0) DbContext.Entry(entity).Property(x =&gt; x.Downloads).IsModified = false;
        return base.UpdateAsync(entity);
    }

    public override Task&lt;bool&gt; UpdateAsync(IEnumerable&lt;ConversionEntity&gt; entities)
    {
        var conversionEntities = entities.ToList();
        foreach (var entity in conversionEntities.Where(entity =&gt; entity.Downloads == 0))
            DbContext.Entry(entity).Property(x =&gt; x.Downloads).IsModified = false;
        return base.UpdateAsync(conversionEntities);
    }

    public override async Task&lt;bool&gt; DeleteAsync(Guid id)
    {
        var conversionEntity = await GetAsync(id);
        if (conversionEntity is null) return false;
        conversionEntity.DateDeleted = DateTimeOffset.Now;
        return await UpdateAsync(conversionEntity);
    }

    public override async Task&lt;bool&gt; DeleteAsync(IEnumerable&lt;Guid&gt; ids)
    {
        var numberDeleted = 0;

        var conversionIds = ids.ToList();

        foreach (var id in conversionIds)
            if (await DeleteAsync(id))
                numberDeleted++;

        return numberDeleted == conversionIds.Count;
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,67,9,82,1],[10,5,10,6,1],[11,5,11,6,1],[14,5,14,6,0],[15,9,15,35,0],[15,36,15,106,0],[16,9,16,41,0],[17,5,17,6,0],[20,5,20,6,1],[21,9,21,52,1],[22,9,22,16,1],[22,18,22,28,0],[22,29,22,31,1],[22,32,22,67,1],[22,67,22,88,0],[22,88,22,89,1],[23,13,23,83,0],[24,9,24,53,1],[25,5,25,6,1],[28,5,28,6,0],[29,9,29,51,0],[30,9,30,38,0],[30,39,30,52,0],[31,9,31,59,0],[32,9,32,52,0],[33,5,33,6,0],[36,5,36,6,0],[37,9,37,31,0],[39,9,39,42,0],[41,9,41,16,0],[41,18,41,24,0],[41,25,41,27,0],[41,28,41,41,0],[42,13,42,39,0],[43,17,43,33,0],[45,9,45,53,0],[46,5,46,6,0]]);
    </script>
  </body>
</html>