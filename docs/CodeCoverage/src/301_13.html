<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\dev\ConvertX.To\src\Presentation\ConvertX.To.API\Program.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using ConvertX.To.API;
using ConvertX.To.API.Middleware;
using ConvertX.To.Application;
using ConvertX.To.Infrastructure.Persistence;
using ConvertX.To.Infrastructure.Shared;
using Hangfire;
using Microsoft.AspNetCore.HttpOverrides;

var builder = WebApplication.CreateBuilder(args);

builder.Configuration.AddJsonFile(&quot;appsettings.secret.json&quot;); // Microsoft Graph Settings, ignored by .gitignore
builder.Configuration.AddEnvironmentVariables(&quot;ConvertXToApi_&quot;);

builder.Services.AddApplication();
builder.Services.AddPersistenceInfrastructure(builder.Configuration);
builder.Services.AddSharedInfrastructure(builder.Configuration);
builder.Services.AddAspNetCoreServices();

if (builder.Environment.IsDevelopment())
{
    builder.Services
        .AddEndpointsApiExplorer(); // Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle
    builder.Services.AddSwaggerGen();    
}


var app = builder.Build();

await app.RunPendingMigrationsAsync();

app.ScheduleRecurringJobs();
app.UseHangfireDashboard();

app.UseMiddleware&lt;ExceptionHandlingMiddleware&gt;();
app.UseMiddleware&lt;ApiExceptionMiddleware&gt;();
app.UseMiddleware&lt;ValidationExceptionMiddleware&gt;();
app.UseForwardedHeaders(new ForwardedHeadersOptions
{
    ForwardedHeaders = ForwardedHeaders.XForwardedFor | ForwardedHeaders.XForwardedProto
});

if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}

app.UseHttpsRedirection();
app.UseRouting();
app.UseAuthorization();

app.UseEndpoints(endpoints =&gt;
{
    endpoints.MapControllers();
    endpoints.MapHangfireDashboard();
});

app.Run();
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,1,9,50,1],[11,1,11,62,1],[12,1,12,65,1],[14,1,14,35,1],[15,1,15,70,1],[16,1,16,65,1],[17,1,17,42,1],[19,1,19,41,1],[20,1,20,2,1],[21,5,22,36,1],[23,5,23,38,1],[24,1,24,2,1],[27,1,27,27,1],[29,1,29,39,1],[31,1,31,29,1],[32,1,32,28,1],[34,1,34,50,1],[35,1,35,45,1],[36,1,36,52,1],[37,1,40,4,1],[42,1,42,37,1],[43,1,43,2,1],[44,5,44,22,1],[45,5,45,24,1],[46,1,46,2,1],[48,1,48,27,1],[49,1,49,18,1],[50,1,50,24,1],[52,1,53,1,1],[53,1,53,2,1],[53,2,54,5,1],[54,5,54,32,1],[54,32,55,5,1],[55,5,55,38,1],[55,38,56,1,1],[56,1,56,2,1],[56,2,56,4,1],[58,1,58,11,1]]);
    </script>
  </body>
</html>